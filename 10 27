#define _CRT_SECURE_NO_DEPRECATE
#include <stdio.h>
#include <math.h>
#include <locale.h>

// Функция вычисляет Y(x) — эталонное значение
double Y(double x) {
    return exp(cos(x)) * cos(sin(x));
}

// Функция вычисляет S(x) как сумму ряда от k=0 до k=n
double S(double x, int n) {
    double sum = 0.0;
    double factorial = 1.0;  // k! для k=0

    for (int k = 0; k <= n; k++) {
        if (k > 0) {
            factorial *= k;  // Вычисляем k! итеративно
        }

        double term = cos(k * x) / factorial;
        sum += term;
    }

    return sum;
}

int main() {
    setlocale(LC_ALL, "rus");
    double x;
    int n;

    // Ввод данных
    printf("Введите x (в радианах): ");
    scanf("%lf", &x);
    printf("Введите n (число членов ряда): ");
    scanf("%d", &n);

    // Вычисление Y(x) и S(x)
    double Y_val = Y(x);
    double S_val = S(x, n);

    // Абсолютная погрешность
    double abs_error = fabs(Y_val - S_val);

    // Относительная погрешность (с проверкой на ноль)
    double rel_error = 0.0;
    if (fabs(Y_val) > 1e-12) {  // Защита от деления на ноль
        rel_error = (abs_error / fabs(Y_val)) * 100.0;
    }
    else {
        printf("Внимание: Y(x) близко к нулю, относительная погрешность не определена.\n");
    }

    // Вывод результатов
    printf("\n--- Результаты ---\n");
    printf("x = %.6f\n", x);
    printf("n = %d\n", n);
    printf("Y(x) (эталон) = %.10f\n", Y_val);
    printf("S(x) (сумма ряда) = %.10f\n", S_val);
    printf("Абсолютная погрешность = %.10f\n", abs_error);
    printf("Относительная погрешность = %.6f%%\n", rel_error);

    return 0;
}
